---
export const prerender = false;

import Title from "@styles/Title.astro";
import Layout from "@layouts/Layout.astro";
import Section from "@styles/Section.astro";
import ExperienceItem from "@components/ExperienceItem.astro";
import TextBuilderParagraph from "@components/TextBuilderParagraph.svelte";
import type { AboutMe } from "../types/sanity";
import { sanityClient } from "sanity:client";
import { PortableText } from "@portabletext/svelte";
import { Image } from "astro:assets";
import { urlFor } from "@utils/sanity";

const aboutMe: AboutMe = await sanityClient.fetch(
  `*[_type == "about"][0]{description,experiences[]{from,to,title,image{asset->{...,metadata}}},image{asset->{...,metadata}}}`
);
---

<Layout title="Angličtina | Petr Walach">
  <main>
    <Section className="h-min pb-20 lg:h-full">
      <div
        class="relative flex flex-col gap-12 lg:flex-row lg:h-full lg:justify-between"
      >
        <Image
          src={urlFor(aboutMe?.image)?.url()}
          alt="Profilová fotka lektora angličtiny Petra Walacha"
          width={aboutMe?.image?.asset?.metadata?.dimensions?.width}
          height={aboutMe?.image?.asset?.metadata?.dimensions?.height}
          loading="lazy"
          decoding="async"
          class="hidden h-full max-h-[60rem] self-center w-[30%] order-1 object-cover lg:flex xl:w-[35%]"
        />

        <div class="flex flex-col gap-2 self-center lg:mt-[-14rem]">
          <Title>O mně</Title>

          <div class="flex flex-col gap-12">
            <Image
              src={urlFor(aboutMe?.image)?.url()}
              alt="Profilová fotka lektora angličtiny Petra Walacha"
              width={aboutMe?.image?.asset?.metadata?.dimensions?.width}
              height={aboutMe?.image?.asset?.metadata?.dimensions?.height}
              loading="lazy"
              decoding="async"
              class="max-w-full w-full h-full object-contain lg:hidden"
            />

            <div class="lg:max-w-[55rem] xl:max-w-[65rem]">
              <PortableText
                value={aboutMe?.description}
                components={{
                  block: {
                    normal: TextBuilderParagraph,
                  },
                }}
              />
            </div>
            <div class="flex flex-col gap-4">
              {
                aboutMe?.experiences?.map((experience) => (
                  <ExperienceItem
                    image={experience?.image}
                    title={experience?.title}
                    from={experience?.from}
                    to={experience?.to}
                  />
                ))
              }
            </div>
          </div>
        </div>
      </div>
    </Section>
  </main>
</Layout>
