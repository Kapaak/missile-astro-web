---
export const prerender = false;

import Title from "@styles/Title.astro";
import Layout from "@layouts/Layout.astro";
import Section from "@styles/Section.astro";
import Text from "@styles/Text.astro";
import TextBuilderParagraph from "@components/TextBuilderParagraph.svelte";
import type { AboutMe } from "../types/sanity";
import { sanityClient } from "sanity:client";
import { PortableText } from "@portabletext/svelte";
import { Image } from "astro:assets";
import { urlFor } from "@utils/sanity";

const aboutMe: AboutMe = await sanityClient.fetch(
  `*[_type == "about"][0]{description,experiences[]{from,to,title,image{asset->{...,metadata}}},image{asset->{...,metadata}}}`
);
---

<Layout title="Angličtina | Petr Walach">
  <main>
    <Section className="h-min pb-20">
      <Title>O mně</Title>
      <div class="flex flex-col gap-10">
        <Image
          src={urlFor(aboutMe?.image)?.url()}
          alt="Profilová fotka lektora angličtiny Petra Walacha"
          width={aboutMe?.image?.asset?.metadata?.dimensions?.width}
          height={aboutMe?.image?.asset?.metadata?.dimensions?.height}
          loading="lazy"
          decoding="async"
          style={{
            maxWidth: "100%",
            width: "100%",
            height: "100%",
            objectFit: "cover",
          }}
        />

        <PortableText
          value={aboutMe?.description}
          components={{
            block: {
              normal: TextBuilderParagraph,
            },
          }}
        />
        <div class="flex flex-col gap-2">
          {
            aboutMe?.experiences?.map((experience) => (
              <div class="flex flex-col gap-4">
                <div class="flex gap-4">
                  <Image
                    src={urlFor(experience?.image)?.url()}
                    alt="Profilová fotka lektora angličtiny Petra Walacha"
                    width={20}
                    height={20}
                    class="shrink-0"
                  />
                  <Text className="text-secondary font-semibold">
                    {experience?.from} - {experience?.to}
                  </Text>
                </div>
                <Text>{experience?.title}</Text>
              </div>
            ))
          }
        </div>
      </div>
    </Section>
  </main>
</Layout>
